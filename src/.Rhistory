theme_minimal() + coord_polar(direction =  -1) + guides(fill = FALSE) + scale_x_continuous(breaks = c(-135,-45,45,135))  +
scale_y_continuous(breaks = seq(-90,90, by = 30)) + labs(x = "Longitude", y = "Latitude")
'%!in%' <- function(x,y)!('%in%'(x,y))
theme_dark <- theme_hc(bgcolor = "darkunica") +
theme(axis.text.x = element_text(colour="white"),
axis.text.y = element_text(colour="white"),
plot.title = element_text(hjust = 0.5),
axis.ticks = element_blank(),
axis.line = element_blank(),
legend.position = "none")
my_countries <- c("United States", "Brazil", "Mexico", "Canada", "Argentina", "China", "Japan", "India", "Korea, Rep.","Iran", "Germany", "United Kingdom", "France", "Italy", "Spain", "Netherlands", "Australia", "New Zealand", "Egypt")
q1 <- gapminder %>% filter(country %in% my_countries, year == 2007)%>%
mutate(gdp = pop * gdpPercap) %>%  select(continent, country, gdp)
q2 <- gapminder %>% filter(country %!in% my_countries, year == 2007)%>%
mutate(igdp = pop * gdpPercap) %>% group_by(continent) %>% summarise(gdp = sum(igdp)) %>% mutate(country = paste("Rest of",continent))
country_colors["Rest of Africa"] <- "#3f3f3f"
country_colors["Rest of Americas"] <- "#3f3f3f"
country_colors["Rest of Asia"] <- "#3f3f3f"
country_colors["Rest of Europe"] <- "#3f3f3f"
bind_rows(q2,q1) %>% ggplot(aes(x = continent, y = round(gdp/1000000000) , fill = fct_reorder(country,gdp, .desc = TRUE)))+
geom_col(color = "black", size = 0.2) +
guides(fill = FALSE) +
theme_dark+
scale_fill_manual(values = country_colors) +
geom_label(aes(label = country ), color = "white",position = position_stack(vjust=1), size = 3) +
labs(x = "Continent" , y = "GDP in Trillions") +
scale_y_continuous(labels = scales::dollar_format())
ggplot(subset(gapminder, year == 1987), aes(continent, lifeExp)) +
geom_violin(aes(fill = continent), alpha = 0.7) +
labs(x = "Continent", y = "Life Expetency") + theme_bw() +
scale_fill_brewer("Continent", palette = "Set1")
ggplot(subset(gapminder, year == 1987), aes(continent, lifeExp)) +
geom_violin(aes(fill = continent), alpha = 0.7) +
labs(x = "Continent", y = "Life Expectancy") + theme_bw() +
scale_fill_brewer("Continent", palette = "Set1") + geom_jitter(alpha = 0.3)
jXlim <- c(150, 115000)
jYlim <- c(16, 100)
ggplot(subset(gapminder, continent != "Oceania"),
aes(x = year, y = lifeExp, group = country, color = country)) +
geom_line(lwd = 1, show_guide = FALSE) + facet_wrap(~ continent) +
scale_color_manual(values = country_colors) +
labs(x = "Year", y = "Life Expectancy") +
theme_bw() + theme(strip.text = element_text(size = rel(1.1)))
world<- map_data("world")
gapminder_df1 <- gapminder %>% filter(continent == "Africa") %>%
mutate(code = countrycode::countrycode(country,"country.name", "iso2c"))
world <- world %>%
mutate(code = countrycode::countrycode(region,"country.name", "iso2c"))
df1 <- left_join(world, gapminder_df1, by = "code")
df1 %>% filter(!is.na(gdpPercap), year %in% c(1952, 2007)) %>%  ggplot() +
geom_polygon(aes(x = long, y = lat, group = group, fill = lifeExp)) +
facet_wrap(~year, scales = "free")  +
scale_fill_distiller("Life Expectancy", palette="RdYlGn", direction = 1) +
theme_bw() +
theme(axis.text.x=element_blank(),axis.ticks.x = element_blank(),
axis.title.x = element_blank(), axis.text.y=element_blank(),
axis.ticks.y = element_blank(), axis.title.y = element_blank(),
strip.text = element_text(size = 12))
africa <- c("Swaziland","Mozambique","Zambia","Sierra Leone","Lesotho","Angola","Zimbabwe", "Liberia","Rwanda","Guinea-Bissau","South Africa","Cameroon","Tanzania","Kenya","Congo, Rep.","Eritrea","Ghana","Morocco","Mauritius","Libya","Reunion")
d1 <- gapminder %>% filter(country %in% africa , year == 1952) %>% mutate(life_1952 = lifeExp)
d2 <- gapminder %>% filter(country %in% africa , year == 2007) %>% mutate(life_2007 = lifeExp)
inner_join(d1,d2 , by="country") %>%
mutate(difference = life_2007 - life_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(fct_reorder(country, difference, .desc = T))) +
geom_bar(aes(weight = difference), fill = "dodgerblue3") +  theme_bw() +
geom_label(aes(country, difference, label = round(difference,1))) +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(x = "Country", y = "Years") +
theme(title = element_text(size = 15), axis.text.x = element_text(size = 12))
#gapminder %>% filter(year == 2007, continent == "Africa") %>% arrange(lifeExp)
jCountries <- c("Canada", "Rwanda", "Cambodia", "Swaziland","Mozambique")
ggplot(subset(gapminder, country %in% jCountries),
aes(x = year, y = lifeExp, color = reorder(country, -1 * lifeExp, max))) +
geom_line() + geom_point() + theme_bw() +
labs(x = "Year", y = "Life expectancy") +
scale_color_brewer("Countries", palette = "Set1")
#gapminder %>% filter(year == 2007) %>% arrange(lifeExp)
world<- map_data("world")
gapminder_df1 <- gapminder %>% filter(continent == "Americas") %>%
mutate(code = countrycode::countrycode(country,"country.name", "iso2c"))
world <- world %>%
mutate(code = countrycode::countrycode(region,"country.name", "iso2c"))
df1 <- left_join(world, gapminder_df1, by = "code")
df1 %>% filter(!is.na(gdpPercap), long < 0, year %in% c(1952, 2007)) %>%  ggplot() +
geom_polygon(aes(x = long, y = lat, group = group, fill = lifeExp)) +
facet_wrap(~year, scales = "free")  +
scale_fill_distiller("Life Expectancy", palette="RdYlGn", direction = 1) +
theme_bw() +
theme(axis.text.x=element_blank(),axis.ticks.x = element_blank(),
axis.title.x = element_blank(), axis.text.y=element_blank(),
axis.ticks.y = element_blank(), axis.title.y = element_blank(),
strip.text = element_text(size = 12))
d1 <- gapminder %>% filter(continent == "Americas" , year == 1952) %>% mutate(life_1952 = lifeExp)
d2 <- gapminder %>% filter(continent == "Americas" , year == 2007) %>% mutate(life_2007 = lifeExp)
inner_join(d1,d2 , by="country") %>%
mutate(difference = life_2007 - life_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
gapminder %>% filter(continent != "Oceania", year == 2007) %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point(aes(size = (pop), fill = country), shape = 21, alpha = 0.9) +
guides(fill = FALSE, size = FALSE) +
facet_wrap(~continent) +
scale_fill_manual(values = country_colors) +
scale_x_log10(limits = jXlim, labels = scales::dollar_format()) + ylim(jYlim) +
scale_size_continuous(range=c(1,40)) +theme_bw() +
theme(strip.text = element_text(size = rel(1.1))) +
labs(x = "GDP Per Capita", y = "Life expectancy")
gapminder %>% filter(continent != "Oceania", year %in% c(1952, 1967, 1992, 2007)) %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point(aes(size = (pop), fill = country), shape = 21, alpha = 0.9) +
guides(fill = FALSE, size = FALSE) +
facet_wrap(~year) +
scale_fill_manual(values = country_colors) +
scale_x_log10(limits = jXlim, labels = scales::dollar_format()) + ylim(jYlim) +
scale_size_continuous(range=c(1,40)) + theme_bw() +
theme(strip.text = element_text(size = rel(1.1)))+
labs(x = "GDP Per Capita", y = "Life expectancy")
jXlim <- c(150, 115000)
jYlim <- c(16, 100)
gapminder %>% filter(continent != "Oceania") %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point(aes(size = (pop), fill = country), shape = 21, alpha = 0.9) +
guides(fill = FALSE, size = FALSE) +
scale_fill_manual(values = country_colors) +
scale_x_log10(limits = jXlim, labels = scales::dollar_format()) + ylim(jYlim) +
scale_size_continuous(range=c(1,10)) + theme_bw() +
theme(strip.text = element_text(size = rel(1.1)))+
labs(x = "GDP Per Capita", y = "Life expectancy") + geom_smooth(size = 2, method = "lm")
col_pt <- brewer.pal(n=8, name = "Paired")[2]
col_accent <- brewer.pal(n=8, name = "Paired")[6]
col_bg <- brewer.pal(n=8, name = "Paired")[8]
suppressPackageStartupMessages(library(ggmap))
set.seed(23)
dat <- tibble(x=runif(20)*0.01-123.2525,
y=runif(20)*0.008+49.257)
get_googlemap(center=c(-123.247985, 49.261263), zoom=16) %>%
ggmap(base_layer = ggplot(dat, aes(x,y))) +
geom_point(size=5, colour=col_pt) +
theme_bw() +
xlab("Longitude") +
ylab("Latitude")
d1 <- gapminder %>% filter(continent == "Americas" , year == 1952) %>% mutate(life_1952 = lifeExp)
d2 <- gapminder %>% filter(continent == "Americas" , year == 2007) %>% mutate(life_2007 = lifeExp)
inner_join(d1,d2 , by="country") %>%
mutate(difference = life_2007 - life_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
inner_join(d1,d2 , by="country") %>%
mutate(difference = gdp_2007 - gdp_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
d1 <- gapminder %>% filter(continent == "Americas" , year == 1952) %>% mutate(gdp_1952 = gdpPercap)
d2 <- gapminder %>% filter(continent == "Americas" , year == 2007) %>% mutate(gdp_2007 = gdpPercap)
inner_join(d1,d2 , by="country") %>%
mutate(difference = gdp_2007 - gdp_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
d1 <- gapminder %>% filter(continent == "Americas" , year == 1952) %>% mutate(gdp_1952 = gdpPercap)
d2 <- gapminder %>% filter(continent == "Americas" , year == 2007) %>% mutate(gdp_2007 = gdpPercap)
inner_join(d1,d2 , by="country") %>%
mutate(difference = gdp_2007 - gdp_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) + scale_x_log10()
d1 <- gapminder %>% filter(continent == "Americas" , year == 1952) %>% mutate(gdp_1952 = gdpPercap)
d2 <- gapminder %>% filter(continent == "Americas" , year == 2007) %>% mutate(gdp_2007 = gdpPercap)
inner_join(d1,d2 , by="country") %>%
mutate(difference = gdp_2007 - gdp_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) + scale_x_log10() +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
d1 <- gapminder %>% filter(continent == "Americas" , year == 1952) %>% mutate(gdp_1952 = gdpPercap)
d2 <- gapminder %>% filter(continent == "Americas" , year == 2007) %>% mutate(gdp_2007 = gdpPercap)
inner_join(d1,d2 , by="country") %>%
mutate(difference = log10(gdp_2007 - gdp_1952)) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
inner_join(d1,d2 , by="country") %>%
mutate(difference = log10(gdp_2007 - gdp_1952)) %>%
select(difference, country, continent.x)
gapminder %>% filter(continent == "Americas" , year == 1952)
gapminder %>% filter(continent == "Americas" , year == 2007)
d1
d2
inner_join(d1,d2 , by="country")
inner_join(d1,d2 , by="country") %>% select(country, gdp_1952, gdp_2007)
d1 <- gapminder %>% filter(continent == "Europe" , year == 1952) %>% mutate(gdp_1952 = gdpPercap)
d2 <- gapminder %>% filter(continent == "Europe" , year == 2007) %>% mutate(gdp_2007 = gdpPercap)
inner_join(d1,d2 , by="country") %>%
mutate(difference = log10(gdp_2007 - gdp_1952)) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
inner_join(d1,d2 , by="country") %>%
mutate(difference = gdp_2007 - gdp_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
d1 <- gapminder %>% filter(continent == "Americas" , year == 1952) %>% mutate(gdp_1952 = gdpPercap)
d2 <- gapminder %>% filter(continent == "Americas" , year == 2007) %>% mutate(gdp_2007 = gdpPercap)
inner_join(d1,d2 , by="country") %>% filter(gdp_2007 > gdp_1952) %>%
mutate(difference = log10(gdp_2007 - gdp_1952)) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
d1 <- gapminder %>% filter(continent == "Americas" , year == 1952) %>% mutate(gdp_1952 = gdpPercap)
d2 <- gapminder %>% filter(continent == "Americas" , year == 2007) %>% mutate(gdp_2007 = gdpPercap)
inner_join(d1,d2 , by="country") %>% filter(gdp_2007 > gdp_1952) %>%
mutate(difference = gdp_2007 - gdp_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
d1 <- gapminder %>% filter(continent == "Americas" , year == 1952) %>% mutate(life_1952 = lifeExp)
d2 <- gapminder %>% filter(continent == "Americas" , year == 2007) %>% mutate(life_2007 = lifeExp)
inner_join(d1,d2 , by="country") %>%
mutate(difference = life_2007 - life_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
d1 <- gapminder %>% filter(continent == "Americas" , year == 1952) %>% mutate(life_1952 = lifeExp)
d2 <- gapminder %>% filter(continent == "Americas" , year == 2007) %>% mutate(life_2007 = lifeExp)
inner_join(d1,d2 , by="country") %>%
mutate(difference = life_2007 - life_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
d1 <- gapminder %>% filter(continent == "Europe" , year == 1952) %>% mutate(gdp_1952 = gdpPercap)
d2 <- gapminder %>% filter(continent == "Europe" , year == 2007) %>% mutate(gdp_2007 = gdpPercap)
inner_join(d1,d2 , by="country") %>% filter(gdp_2007 > gdp_1952) %>%
mutate(difference = gdp_2007 - gdp_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = log10(difference), fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
inner_join(d1,d2 , by="country") %>% filter(gdp_2007 > gdp_1952) %>%
mutate(difference = gdp_2007 - gdp_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(country)) +
geom_bar(aes(weight = difference, fill = difference)) +  theme_minimal() +
geom_label(aes(country, difference, label = round(difference,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
gapminder %>% filter(continent == "Africa" , year == 2007) %>% ggplot(aes(country)) +
geom_bar(aes(weight = lifeExp, fill = lifeExp)) +  theme_minimal() +
geom_label(aes(country, lifeExp, label = round(lifeExp,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
gapminder %>% filter(continent == "America" , year == 2007) %>% ggplot(aes(country)) +
geom_bar(aes(weight = lifeExp, fill = lifeExp)) +  theme_minimal() +
geom_label(aes(country, lifeExp, label = round(lifeExp,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
gapminder %>% filter(continent == "Americas" , year == 2007) %>% ggplot(aes(country)) +
geom_bar(aes(weight = lifeExp, fill = lifeExp)) +  theme_minimal() +
geom_label(aes(country, lifeExp, label = round(lifeExp,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
gapminder %>% filter(continent == "Americas" , year == 2007) %>% ggplot(aes(country)) +
geom_bar(aes(weight = lifeExp, fill = lifeExp)) +  theme_minimal() +
geom_label(aes(country, lifeExp, label = round(lifeExp,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
gapminder %>% filter(continent == "Africa" , year == 2007) %>% ggplot(aes(country)) +
geom_bar(aes(weight = lifeExp, fill = lifeExp)) +  theme_minimal() +
geom_label(aes(country, lifeExp, label = round(lifeExp,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
africa <- c("Swaziland","Mozambique","Zambia","Sierra Leone","Lesotho","Angola","Zimbabwe", "Liberia","Rwanda","Guinea-Bissau","South Africa","Cameroon","Tanzania","Kenya","Congo, Rep.","Eritrea","Ghana","Morocco","Mauritius","Libya","Reunion")
gapminder %>% filter(country %in% africa , year == 2007) %>% ggplot(aes(country)) +
geom_bar(aes(weight = lifeExp, fill = lifeExp)) +  theme_minimal() +
geom_label(aes(country, lifeExp, label = round(lifeExp,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
gapminder %>% filter(continent == "Africa" , year == 2007)
gapminder %>% filter(continent == "Africa" , year == 2007) %>% arrange(lifeExp)
africa <- c("Swaziland","Mozambique","Zambia","Sierra Leone","Lesotho","Angola","Zimbabwe", "Liberia","Rwanda","Guinea-Bissau","South Africa","Cameroon","Tanzania","Kenya","Congo, Rep.","Eritrea","Ghana","Comoros","Egypt","Mauritania","Morocco","Mauritius","Libya","Reunion")
gapminder %>% filter(country %in% africa , year == 2007) %>% ggplot(aes(country)) +
geom_bar(aes(weight = lifeExp, fill = lifeExp)) +  theme_minimal() +
geom_label(aes(country, lifeExp, label = round(lifeExp,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
gapminder %>% filter(continent == "Africa" , year == 2007) %>% arrange(lifeExp)
africa <- c("Swaziland","Mozambique","Reunion","Zambia","Sierra Leone","Libya" ,"Lesotho","Angola","Zimbabwe", "Liberia","Rwanda","Morocco","Guinea-Bissau","South Africa","Cameroon","Tanzania","Kenya","Congo, Rep.","Eritrea","Ghana","Comoros","Egypt","Mauritania","Mauritius")
gapminder %>% filter(country %in% africa , year == 2007) %>% ggplot(aes(country)) +
geom_bar(aes(weight = lifeExp, fill = lifeExp)) +  theme_minimal() +
geom_label(aes(country, lifeExp, label = round(lifeExp,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
gapminder %>% filter(continent == "Africa" , year == 2007) %>% arrange(lifeExp)
africa <- c("Mauritius","Swaziland","Mozambique","Reunion","Zambia","Sierra Leone","Libya" ,"Lesotho","Angola","Zimbabwe", "Liberia","Rwanda","Morocco","Guinea-Bissau","South Africa","Cameroon","Tanzania","Kenya","Congo, Rep.","Eritrea","Ghana","Comoros","Egypt","Mauritania")
gapminder %>% filter(country %in% africa , year == 2007) %>% ggplot(aes(country)) +
geom_bar(aes(weight = lifeExp, fill = lifeExp)) +  theme_minimal() +
geom_label(aes(country, lifeExp, label = round(lifeExp,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
gapminder %>% filter(continent == "Africa" , year == 2007) %>% arrange(lifeExp)
gapminder %>% filter(continent == "Africa" , year == 2007) %>% arrange(lifeExp)
africa <- c("Mauritius","Swaziland","Mozambique","Reunion","Zambia","Angola","Libya" ,"Lesotho","Angola","Zimbabwe", "Liberia","Rwanda","Morocco","Guinea-Bissau","South Africa","Cameroon","Tanzania","Kenya","Congo, Rep.","Eritrea","Ghana","Comoros","Egypt","Mauritania")
gapminder %>% filter(country %in% africa , year == 2007) %>% ggplot(aes(country)) +
geom_bar(aes(weight = lifeExp, fill = lifeExp)) +  theme_minimal() +
geom_label(aes(country, lifeExp, label = round(lifeExp,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
gapminder %>% filter(continent == "Africa" , year == 2007) %>% arrange(lifeExp)
africa <- c("Mauritius","Swaziland","Mozambique","Reunion","Zambia","Angola","Libya" ,"Lesotho","Angola","Zimbabwe", "Liberia","Rwanda","Morocco","Guinea-Bissau","South Africa","Cameroon","Tanzania","Kenya","Congo, Rep.","Eritrea","Ghana","Comoros","Egypt","Mauritania", "Madagascar", "Senegal")
gapminder %>% filter(country %in% africa , year == 2007) %>% ggplot(aes(country)) +
geom_bar(aes(weight = lifeExp, fill = lifeExp)) +  theme_minimal() +
geom_label(aes(country, lifeExp, label = round(lifeExp,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Purples", direction=1)
gapminder %>% filter(continent == "Africa" , year == 2007) %>% arrange(lifeExp)
africas <- c("Mauritius","Swaziland","Mozambique","Zambia","Angola","Libya" ,"Lesotho","Angola","Zimbabwe", "Liberia","Rwanda","Morocco","Guinea-Bissau","South Africa","Cameroon","Tanzania","Kenya","Congo, Rep.","Eritrea","Ghana","Comoros","Egypt","Mauritania", "Madagascar", "Senegal")
gapminder %>% filter(country %in% africas , year == 2007) %>% ggplot(aes(country)) +
geom_bar(aes(weight = lifeExp, fill = lifeExp)) +  theme_minimal() +
geom_label(aes(country, lifeExp, label = round(lifeExp,1)), size = 3, label.padding = unit(0.10, "lines")) +
theme(axis.text.x=element_text(angle=0,size = 9), axis.text.y=element_blank(), axis.ticks.y = element_blank(), axis.title.y = element_blank()) +
labs(x = "Country", y = "Years") +
coord_polar() + scale_fill_distiller("Years", palette="Reds", direction=1)
bind_rows(q2,q1) %>% ggplot(aes(x = continent, y = round(gdp/1000000000) , fill = fct_reorder(country,gdp, .desc = TRUE)))+
geom_col(color = "black", size = 0.2) +
guides(fill = FALSE) +
theme_dark+
scale_fill_manual(values = country_colors) +
geom_label(aes(label = country ), color = "white",position = position_stack(vjust=1), size = 3) +
labs(x = "Continent" , y = "GDP in Trillions") +
scale_y_continuous(labels = scales::dollar_format()) + coord_polar()
bind_rows(q2,q1) %>% ggplot(aes(x = continent, y = round(gdp/1000000000) , fill = fct_reorder(country,gdp, .desc = TRUE)))+
geom_col(color = "black", size = 0.2) +
guides(fill = FALSE) +
theme_dark+
scale_fill_manual(values = country_colors) +
geom_label(aes(label = country ), color = "white",position = position_stack(vjust=1), size = 3) +
labs(x = "Continent" , y = "GDP in Trillions") +
scale_y_continuous(labels = scales::dollar_format())
ggplot(subset(gapminder, year == 1987, continent != "Oceania"), aes(continent, lifeExp)) +
geom_violin(aes(fill = continent), alpha = 0.7) +
labs(x = "Continent", y = "Life Expetency") + theme_bw() +
scale_fill_brewer("Continent", palette = "Set1")
gapminder %>% filter(continent != "Oceania", year == 1987) %>% fct_drop() %>% ggplot(), aes(continent, lifeExp)) +
gapminder %>% filter(continent != "Oceania", year == 1987) %>% fct_drop() %>% ggplot(), aes(continent, lifeExp)) + geom_violin(aes(fill = continent), alpha = 0.7) +
gapminder %>% filter(continent != "Oceania", year == 1987) %>% fct_drop() %>% ggplot(aes(continent, lifeExp)) + geom_violin(aes(fill = continent), alpha = 0.7) +
labs(x = "Continent", y = "Life Expetency") + theme_bw() +
scale_fill_brewer("Continent", palette = "Set1")
gapminder %>% filter(continent != "Oceania", year == 1987) %>% droplevels() %>% ggplot(aes(continent, lifeExp)) + geom_violin(aes(fill = continent), alpha = 0.7) +
labs(x = "Continent", y = "Life Expetency") + theme_bw() +
scale_fill_brewer("Continent", palette = "Set1")
ggplot(subset(gapminder, year == 1987, continent != "Oceania"), aes(continent, gdpPercap)) +
geom_boxplot(aes(fill = continent)) +
labs(x = "Continent", y = "GDP Per Capita") + theme_bw() +
scale_fill_brewer("Continent", palette = "Dark2") + geom_jitter(alpha = 0.3) + scale_y_continuous(labels = scales::dollar_format())
ggplot(subset(gapminder, year == 1987, continent != "Oceania"), aes(continent, gdpPercap)) +
geom_boxplot(aes(fill = continent)) +
labs(x = "Continent", y = "GDP Per Capita") + theme_bw() +
scale_fill_brewer("Continent", palette = "Set2") + geom_jitter(alpha = 0.3) + scale_y_continuous(labels = scales::dollar_format())
ggplot(subset(gapminder, year == 1987, continent != "Oceania"), aes(continent, gdpPercap)) +
geom_boxplot(aes(fill = continent)) +
labs(x = "Continent", y = "GDP Per Capita") + theme_bw() +
scale_fill_brewer("Continent", palette = "Set1") + geom_jitter(alpha = 0.3) + scale_y_continuous(labels = scales::dollar_format())
gapminder %>% filter(continent != "Oceania", year == 1987) %>% droplevels() %>% ggplot(aes(continent, lifeExp)) + geom_violin(aes(fill = continent)) +
labs(x = "Continent", y = "Life Expetency") + theme_bw() +
scale_fill_brewer("Continent", palette = "Set1")
ggplot(subset(gapminder, year == 1987), aes(continent, lifeExp)) +
geom_violin(aes(fill = continent)) +
labs(x = "Continent", y = "Life Expectancy") + theme_bw() +
scale_fill_brewer("Continent", palette = "Set1") + geom_jitter(alpha = 0.3)
ggplot(subset(gapminder, year == 1987), aes(continent, lifeExp)) +
geom_violin(aes(fill = continent)) +
labs(x = "Continent", y = "Life Expectancy") + theme_bw() +
scale_fill_brewer("Continent", palette = "Set1") + geom_jitter(alpha = 0.4)
ggplot(subset(gapminder, year == 1987, continent != "Oceania"), aes(continent, gdpPercap)) +
geom_boxplot(aes(fill = continent)) +
labs(x = "Continent", y = "GDP Per Capita") + theme_bw() +
scale_fill_brewer("Continent", palette = "Set1") + scale_y_continuous(labels = scales::dollar_format())
jCountries <- c("Canada", "Rwanda", "Cambodia", "Swaziland","Mozambique")
ggplot(subset(gapminder, country %in% jCountries),
aes(x = year, y = lifeExp, color = reorder(country, -1 * lifeExp, max))) +
geom_line() + geom_point() + theme_bw() +
labs(x = "Year", y = "Life expectancy") +
scale_color_brewer("Countries", palette = "Set1")
#gapminder %>% filter(year == 2007) %>% arrange(lifeExp)
inner_join(d1,d2 , by="country") %>%
mutate(difference = life_2007 - life_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(fct_reorder(country, difference, .desc = T))) +
geom_bar(aes(weight = difference), fill = "dodgerblue3") +  theme_bw() +
geom_label(aes(country, difference, label = round(difference,1))) +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(x = "Country", y = "Years") +
theme(title = element_text(size = 15), axis.text.x = element_text(size = 12))
africa <- c("Swaziland","Mozambique","Zambia","Sierra Leone","Lesotho","Angola","Zimbabwe", "Liberia","Rwanda","Guinea-Bissau","South Africa","Cameroon","Tanzania","Kenya","Congo, Rep.","Eritrea","Ghana","Morocco","Mauritius","Libya","Reunion")
d1 <- gapminder %>% filter(country %in% africa , year == 1952) %>% mutate(life_1952 = lifeExp)
d2 <- gapminder %>% filter(country %in% africa , year == 2007) %>% mutate(life_2007 = lifeExp)
inner_join(d1,d2 , by="country") %>%
mutate(difference = life_2007 - life_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(fct_reorder(country, difference, .desc = T))) +
geom_bar(aes(weight = difference), fill = "dodgerblue3") +  theme_bw() +
geom_label(aes(country, difference, label = round(difference,1))) +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(x = "Country", y = "Years") +
theme(title = element_text(size = 15), axis.text.x = element_text(size = 12))
#gapminder %>% filter(year == 2007, continent == "Africa") %>% arrange(lifeExp)
africa <- c("Swaziland","Mozambique","Zambia","Sierra Leone","Lesotho","Angola","Zimbabwe", "Liberia","Rwanda","Guinea-Bissau","South Africa","Cameroon","Tanzania","Kenya","Congo, Rep.","Eritrea","Ghana","Morocco","Mauritius","Libya","Reunion")
d1 <- gapminder %>% filter(country %in% africa , year == 1952) %>% mutate(life_1952 = lifeExp)
d2 <- gapminder %>% filter(country %in% africa , year == 2007) %>% mutate(life_2007 = lifeExp)
inner_join(d1,d2 , by="country") %>%
mutate(difference = life_2007 - life_1952) %>%
select(difference, country, continent.x) %>%
ggplot(aes(fct_reorder(country, difference, .desc = T))) +
geom_bar(aes(weight = difference), fill = "dodgerblue3", color = "black") +  theme_bw() +
geom_label(aes(country, difference, label = round(difference,1))) +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
labs(x = "Country", y = "Years") +
theme(title = element_text(size = 15), axis.text.x = element_text(size = 12))
#gapminder %>% filter(year == 2007, continent == "Africa") %>% arrange(lifeExp)
jXlim <- c(150, 115000)
jYlim <- c(16, 100)
gapminder %>% filter(continent != "Oceania") %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point(aes(size = (pop), fill = country), shape = 21, alpha = 0.9) +
guides(fill = FALSE, size = FALSE) +
scale_fill_manual(values = country_colors) +
scale_x_log10(limits = jXlim, labels = scales::dollar_format()) + ylim(jYlim) +
scale_size_continuous(range=c(1,10)) + theme_bw() +
theme(strip.text = element_text(size = rel(1.1)))+
labs(x = "GDP Per Capita", y = "Life expectancy") + geom_smooth(size = 2, method = "lm")
jXlim <- c(150, 115000)
jYlim <- c(16, 100)
gapminder %>% filter(continent != "Oceania") %>%
ggplot(aes(x = gdpPercap, y = lifeExp)) +
geom_point(aes(size = (pop), fill = country), shape = 21, alpha = 0.9) +
guides(fill = FALSE, size = FALSE) +
scale_fill_manual(values = country_colors) +
scale_x_log10(limits = jXlim, labels = scales::dollar_format()) + ylim(jYlim) +
scale_size_continuous(range=c(1,10)) + theme_bw() +
theme(strip.text = element_text(size = rel(1.1)))+
labs(x = "GDP Per Capita", y = "Life expectancy") + geom_smooth(size = 2)
wordcloud(words = d$word, freq = d$freq, min.freq = 1,
random.order=FALSE, colors=brewer.pal(10, "Set1"))
wordcloud(words = d$word, freq = d$freq, min.freq = 1,
random.order=FALSE, colors=brewer.pal(10, "Dark2"))
